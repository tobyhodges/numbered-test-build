{% comment %}
- subsec: the relevant sub-section of contents from _config.yml
- collection: the type of page that will be linked to e.g. episodes or extras
- class: the CSS class to apply to the list.
- title: dropdown title.
{% endcomment %}

<li class="dropdown">
  <a href="{{ relative_root_path }}/" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{ include.title }} <span class="caret"></span></a>
  <ul class="dropdown-menu">
    {% comment %}List extras by alphabetical order if this is the Extras menu and if site.contents is not defined.{% endcomment %}
    {% comment %}But first add "Reference" link at the top.{% endcomment %}
  {% if include.title == "Extras" %}
    <li><a href="{{ relative_root_path }}{% link reference.md %}">Reference</a></li>
    {% unless site.contents %}
      {% for extra in site.extras %}
        <li><a href="{{ relative_root_path }}{{ extra.url }}">{{ extra.title }}</a></li>
      {% endfor %}
    {% endunless %}
  {% endif %}
  {% if site.contents %}
    {% comment %}List entries according to order in _config.yml. Search to find this page (because Jekyll does not support lookup by key).{% endcomment %}
    {% for lsn in include.subsec %}
      {% for item in include.collection %}
        {% comment %}If there's a match, add a link to the dropdown menu.{% endcomment %}
        {% if lsn == item.slug %}
          <li><a href="{{ relative_root_path }}{{ item.url }}">{{ item.title }}</a></li>
        {% break %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  {% endif %}
  {% comment %}List episodes by numeric order if this is the Episodes menu and if site.contents is not defined.{% endcomment %}
  {% comment %}Then add "All-In-One" link.{% endcomment %}
  {% if include.title == "Episodes" %}
    {% unless site.contents %}
      {% for episode in site.episodes %}
        <li><a href="{{ relative_root_path }}{{ episode.url }}">{{ episode.title }}</a></li>
      {% endfor %}
    {% endunless %}
    <li role="separator" class="divider"></li>
    <li><a href="{{ relative_root_path }}{% link aio.md %}">All in one page (Beta)</a></li>
  {% endif %}
  </ul>
</li>
